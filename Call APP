


#cs ----------------------------------------------------------------------------

 AutoIt Version: 3.3.10.2
 Author:         myName

 Script Function:
	Template AutoIt script.

#ce ----------------------------------------------------------------------------
#include <Excel.au3>
#include <GUIConstantsEx.au3>
#include <File.au3>
#include <MsgBoxConstants.au3>
; Script Start - Add your code below here

;$oExcel = _ExcelBookOpen("C:\DTCanada\XML\VerifyXMLDetails_Testdata.xls")
;local $sFilePath = "C:\\DTCanada\XML\AppNo.txt"

;Local $hFileOpen = FileOpen($sFilePath, $FO_READ)
 ;   If $hFileOpen = -1 Then
 ;       MsgBox($MB_SYSTEMMODAL, "", "An error occurred when reading the file.")
 ;       Return False
 ;  EndIf

;Local $sFileRead = FileRead($hFileOpen)
    ; Close the handle returned by FileOpen.
;FileClose($hFileOpen)
Local $file = FileOpen("C:\\XML_Mapping_BMO\Common\AppNo.txt", 0)
Local $line = FileReadLine($file)
    ; Display the contents of the file.

sleep(5000)
;$sCellValue =_ExcelReadCell($oExcel, 2, 2)
ShellExecute("C:\GET XML-64 bit\GET_XML\PortalGetXML.Application")
WinActivate("Get XML")
sleep(6000)
;WinActivate("Get XML")
WinSetState("Get XML", "", @SW_MAXIMIZE)
sleep(6000)
;ClipPut($sCellValue)
;Send("abc")
ControlFocus("Get XML","","[CLASS:WindowsForms10.EDIT.app.0.34f5582_r14_ad1;INSTANCE:1]")
ControlSetText("Get XML","","[CLASS:WindowsForms10.EDIT.app.0.34f5582_r14_ad1;INSTANCE:1]",$line)
sleep(6000)
$win = WinWait("Get XML", "Get")
ControlClick($win, "", "[CLASS:WindowsForms10.BUTTON.app.0.34f5582_r14_ad1; INSTANCE:6]")
 ;Send("{ENTER}")
Sleep(20000)
;Send("{TAB 5}")
ControlFocus("Get XML","","[NAME:sentLogView]")
ControlClick("Get XML","","[CLASS:WindowsForms10.Window.8.app.0.34f5582_r14_ad1;INSTANCE:7]","right")
;MouseClick("right",425,30)
Sleep(10000)
Send("{DOWN 3}")
Sleep(10000)
Send("{ENTER}")
Sleep(10000)
WinActivate("Save As")
Sleep(10000)
ControlFocus("Save As","","[CLASS:Edit;INSTANCE:1]")
ControlSend("Save As","","[CLASS:Edit;INSTANCE:1]","C:\XML_Mapping_BMO\Files\SentXML")
;Send("C:\XML_Mapping\Files\SentXML")
Sleep(10000)
ControlFocus("Save As","","[CLASS:Button;INSTANCE:1]")
ControlSend("Save As","","[CLASS:Button;INSTANCE:1]","{ENTER}")
;Send("{TAB 3}")
;sleep(6000)
;Send("{ENTER}")
sleep(10000)
If WinExists("Confirm Save As") Then
   ControlClick("Confirm Save As","","[CLASS:Button;INSTANCE:1]")
EndIf
sleep(5000)
WinClose("Get XML")
